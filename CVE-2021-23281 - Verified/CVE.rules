alert tcp any any -> any any (
    msg:"IPM Exploit Attempt: coverterCheckList, date, and IP in URI - CVE-2021-23281";
    flow:to_server,established;
    http_uri;
    content:"coverterCheckList"; 
    content:"date=";
    pcre:"/\b(?:\d{1,3}\.){3}\d{1,3}\b/"; 
    sid:1000004; rev:1;
)

alert tcp any any -> any any (
    msg:"IPM Exploit Attempt: coverterCheckList in URI, date and IP in body";
    flow:to_server,established;
    http_uri;
    content:"coverterCheckList"; 
    http_client_body;
    content:"date=";
    pcre:"/\b(?:\d{1,3}\.){3}\d{1,3}\b/"; 
    sid:1000005; rev:1;
)

alert tcp any any -> any any (
    msg:"IPM Exploit Attempt: coverterCheckList, date, and snmp server in URI";
    flow:to_server,established;
    http_uri;
    content:"coverterCheckList";
    http_uri;
    content:"date="; 
    http_uri;
    content:"snmp://";
    sid:1000006; rev:1;
)

alert tcp any any -> any any (
    msg:"IPM Exploit Attempt: coverterCheckList in URI, date and snmp in body";
    flow:to_server,established;
    http_uri;
    content:"coverterCheckList"; 
    http_client_body;
    content:"date="; 
    content:"snmp://"; 
    sid:1000007; rev:1;
)

